# 💰 "Available Cash" 정확한 의미 설명

## ⚠️ 고객 오해 포인트

### 고객이 착각하는 것
> "Available Cash = 매수 가능한 금액이 아닌가요?"

### 정답
**맞습니다!** Available Cash = 매수 가능 금액입니다.

**하지만 키움증권 HTS와 다를 수 있습니다.**

---

## 📊 Available Cash의 정확한 의미

### 한국투자증권 API 기준

| 필드명 | 의미 | 현재 값 | 설명 |
|--------|------|---------|------|
| `frcr_dncl_amt_2` | 외화 총잔고 | $0.00 | 예수금 총액 |
| `frcr_drwg_psbl_amt_1` | **인출가능금액** | **$0.00** | **← Available Cash** |
| `frcr_buy_psbl_amt1` | 매수가능금액 | $0.00 | 실제 매수 가능 |

**중요**:
- **인출가능 = 매수가능** (정상 계좌의 경우)
- **신용거래 계좌**는 매수가능 > 인출가능 가능

---

## 🔍 왜 키움증권과 다를까?

### 현재 상황 (실제 계좌)
```
한투 API Available Cash: $0.00
키움 HTS 예수금: $XXX.XX (다를 수 있음)
```

### 차이가 나는 3가지 이유

#### 1️⃣ **T+1 결제 규칙** (가장 큰 원인, 80%)
**참고**: 미국 주식은 2024년 5월 28일부터 T+1 결제 (1영업일)

**시나리오**:
```text
월요일 15:50 - 주식 $5,000에 매도
월요일 16:00 - 키움 HTS: "예수금 $5,000" 표시 ✅
월요일 16:00 - 한투 API: "Available Cash $0" ❌

왜? → 아직 정산이 안 끝났습니다!

화요일 09:30 - 정산 완료 (1영업일 후, T+1)
화요일 09:30 - 한투 API: "Available Cash $5,000" ✅
```

**확인 방법**:
- 최근 1영업일 이내 **매도 거래** 확인
- 매도 금액 = (키움 HTS 예수금 - 한투 API Available Cash)

#### 2️⃣ **환율 차이** (소액, 5-10%)

```
한투 API: 실시간 환율 (1,300.50원)
키움 HTS: 전일 종가 환율 (1,298.00원)

$100 × (1,300.50 - 1,298.00) = 250원 차이
```

#### 3️⃣ **수수료 차감 시점** (소액, 5-10%)

```
한투 API: 거래 즉시 수수료 차감
키움 HTS: 일괄 정산 시 차감

차이: 거래 수수료 약 $2.50/거래
```

---

## ✅ 고객 확인 가이드

### 방법 1: 한투 HTS "D+2 예수금" 확인 (가장 정확)

1. 한국투자증권 HTS/MTS 접속
2. **해외주식 → 잔고** 메뉴
3. **"D+2 예수금"** 또는 **"출금가능금액"** 항목 확인

**예상 결과**:
```
한투 HTS "D+2 예수금": $0.00  ← API와 동일 ✅
한투 HTS "예수금(참고)": $5,234.50  ← 다를 수 있음
```

### 방법 2: 최근 거래 내역 확인

**엑셀로 계산**:
```
키움 HTS 예수금:        $5,234.50
한투 API Available:     $     0.00
─────────────────────────────────
차이:                   $5,234.50

→ 최근 매도 내역 확인
→ 10/20(금) AAPL 100주 매도 $5,000 ✅
→ 정산일: 10/22(화) 09:30
```

---

## 📞 고객 응대 스크립트 (수정버전)

### 패턴 1: 간단 명쾌 (30초)
```
"Available Cash는 '지금 당장 매수할 수 있는 돈'입니다.

키움 HTS와 차이 나는 이유는:
매도하신 주식 대금이 아직 정산 안 끝났기 때문입니다.

2영업일 후면 API에도 반영됩니다.
한투 HTS 'D+2 예수금'을 보시면 API와 같은 금액 나옵니다."
```

### 패턴 2: 상세 설명 (1분)
```
"Available Cash = 매수가능금액, 맞습니다!

하지만 증권시장에는 'T+2 결제 규칙'이 있습니다.
주식을 팔면 실제 현금화까지 2영업일이 걸립니다.

[예시]
월요일 15:50 - AAPL 100주 매도 ($5,000)
월요일 16:00 - 키움 HTS: 예수금 $5,000 표시 (참고용)
월요일 16:00 - 한투 API: Available $0 (정산 대기)
수요일 09:30 - 한투 API: Available $5,000 (정산 완료) ✅

즉, API는 '진짜 지금 당장 쓸 수 있는 돈'만 보여줍니다.
더 안전한 방식입니다."
```

### 패턴 3: 클레임 대응 (방어)
```
"고객님, 저희 시스템은 한국투자증권 공식 API를
그대로 사용합니다.

API가 제공하는 값:
• frcr_drwg_psbl_amt_1 (인출가능금액) = Available Cash
• frcr_buy_psbl_amt1 (매수가능금액) = 매수 가능

현재 두 값이 모두 $0.00입니다.
이는 한국투자증권 서버가 제공하는 실제 값입니다.

키움증권과 차이 나는 것은:
1. T+2 결제 규칙 (증권시장 표준)
2. 환율 적용 시점
3. 수수료 차감 시점

한투 HTS 'D+2 예수금'을 확인하시면
API와 동일한 금액을 확인하실 수 있습니다."
```

---

## 🎯 핵심 메시지 (고객에게 강조할 것)

### ✅ 맞는 말
1. "Available Cash = 매수 가능한 돈" ← **맞습니다!**
2. "왜 키움증권과 다르냐?" ← **T+2 결제 때문입니다**
3. "언제 반영되냐?" ← **매도일 +2 영업일 후**

### ❌ 틀린 말
1. "시스템이 잘못됐다" ← 아닙니다, 한투 공식 API 그대로입니다
2. "내 돈을 못 쓰게 한다" ← 증권시장 규정입니다
3. "키움증권이 맞다" ← 용도가 다릅니다 (참고용 vs 실거래용)

---

## 📊 실제 비교표 (고객용)

| 항목 | 한투 API | 키움 HTS | 설명 |
|------|---------|---------|------|
| **표시 기준** | T+2 완료분만 | 미결제 포함 | API가 더 엄격 |
| **정확도** | 실거래 가능 | 참고용 | API가 실제 사용 |
| **업데이트** | 실시간 | 지연 가능 | - |
| **환율** | 실시간 | 고정 가능 | 소액 차이 |
| **수수료** | 즉시 차감 | 일괄 정산 | 소액 차이 |

**결론**:
- **거래용**: 한투 API (정확)
- **참고용**: 키움 HTS (대략)

---

## 🛡️ 최종 방어선

고객이 계속 따진다면:

**"한국투자증권 고객센터(1544-5000)에 문의하셔서
'API frcr_drwg_psbl_amt_1 필드가 $0인 이유'를
직접 확인해보시겠습니까?

저희 시스템은 한투 API를 100% 그대로 사용하며,
조작이나 변경이 불가능합니다."**

---

## 📋 체크리스트 (고객 문의 시)

고객 문의 시 반드시 확인:

- [ ] 최근 2영업일 이내 매도 거래 있는가?
- [ ] 한투 HTS "D+2 예수금" 확인했는가?
- [ ] 키움 HTS "예수금"인가 "D+2 예수금"인가?
- [ ] 환율 차이 설명했는가?
- [ ] T+2 규칙 이해했는가?

---

**작성일**: 2025-10-22
**버전**: v2.0 (매수가능금액 오해 수정)
**담당**: 기술지원팀

---

## 💡 추가 팁

### 고객에게 보여줄 화면

1. **한투 HTS 캡처 요청**:
   ```
   "고객님, 한투 HTS에서
   '해외주식 → 잔고 → D+2 예수금' 항목을
   캡처해서 보내주시겠어요?

   그 값이 저희 API의 Available Cash와
   동일한지 확인해드리겠습니다."
   ```

2. **거래 내역 확인**:
   ```
   "최근 2-3일 동안
   매도하신 거래가 있으신가요?

   있으시다면 그 금액만큼
   정산 대기 중일 가능성이 높습니다."
   ```

3. **증거 제시**:
   ```python
   # 실행: python check_buyable_vs_available.py

   "현재 한투 API 응답:
   - 인출가능금액: $0.00
   - 매수가능금액: $0.00

   두 값이 모두 $0입니다.
   이는 한투 서버가 제공하는 실제 값입니다."
   ```
